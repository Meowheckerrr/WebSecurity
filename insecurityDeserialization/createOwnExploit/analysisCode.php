<?php

class product{

    private $name;

    public function __construct($name)
    {
        $this->name = $name;
    }
    public function getName(){
        return $this->name;
    }
}

class coustomTemplate{

    private $userName;
    public $product;
    
    public function __construct($userName)
    {
     $this->userName = $userName;
     $this->buildProduct();
    }
    public function __sleep()
    {
        return ["userName"]; //Before the serialize (it will be keeped !!)
    }
    public function __destruct()
    {
        $this->buildProduct();
    }
    private function buildProduct(){
        $this->product = new product($this->userName);
    }
}

//serialize the obj
$template = new coustomTemplate("meowheckerTest");
$serialize = serialize($template);
echo "serialize Obj:\n" . $serialize . "\n";

//unserialize the obj
echo ("------------------------------------------------\n");
$unserialize = unserialize($serialize);
echo ("unserialize Obj\n");
print_r($unserialize);

echo $template->product->getName();

?>